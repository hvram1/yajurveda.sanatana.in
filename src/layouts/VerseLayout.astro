---
import BaseLayout from './BaseLayout.astro';
import Sidebar from '../components/Sidebar.astro';

interface Props {
  title: string;
  currentKanda: number;
  currentPrasna: number;
  currentAnuvaka: number;
  currentPanchasat: number;
  basePath?: string;
  activeText?: 'ts' | 'tb' | 'ta';
}

const { title, currentKanda, currentPrasna, currentAnuvaka, currentPanchasat, basePath, activeText } = Astro.props;
const base = basePath || import.meta.env.BASE_URL;
const rootBase = import.meta.env.BASE_URL;
---

<BaseLayout title={title} activeText={activeText}>
  <div class="page-with-sidebar">
    <Sidebar 
      currentKanda={currentKanda} 
      currentPrasna={currentPrasna} 
      currentAnuvaka={currentAnuvaka}
      currentPanchasat={currentPanchasat}
      basePath={base}
    />
    <div class="main-content">
      <!-- Breadcrumb -->
      <nav class="breadcrumb mb-6 text-sm">
        <a href={rootBase}>मुख्यपृष्ठम्</a>
        <span class="mx-2">›</span>
        {activeText === 'ts' && (
          <>
            <a href={`${rootBase}ts/`}>संहिता</a>
            <span class="mx-2">›</span>
          </>
        )}
        <a href={`${base}kanda/${currentKanda}`}>काण्डम् {currentKanda}</a>
        <span class="mx-2">›</span>
        <a href={`${base}prasna/${currentKanda}/${currentPrasna}`}>प्रश्नः {currentPrasna}</a>
        <span class="mx-2">›</span>
        <span>अनुवाकः {currentAnuvaka} - पञ्चाशत् {currentPanchasat}</span>
      </nav>

      <slot />

      <!-- Navigation between verses -->
      <div class="flex justify-between mt-8 pt-4 border-t">
        <a 
          href={`${base}prasna/${currentKanda}/${currentPrasna}`}
          class="nav-link bg-teal-50 rounded"
        >
          ← प्रश्नः {currentPrasna}
        </a>
        <a 
          href={`${base}kanda/${currentKanda}`}
          class="nav-link bg-teal-50 rounded"
        >
          काण्डम् {currentKanda} →
        </a>
      </div>
    </div>
  </div>
</BaseLayout>

<style>
  .page-with-sidebar {
    display: flex;
    min-height: calc(100vh - 200px);
  }
  
  .main-content {
    flex: 1;
    padding: 2rem;
    max-width: 900px;
  }
  
  @media (max-width: 768px) {
    .page-with-sidebar {
      flex-direction: column;
    }
    
    .main-content {
      padding: 1rem;
    }
  }
</style>
